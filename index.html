<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QR Test</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.3/qrcode.min.js"></script>
</head>
<body>
  <textarea id="textEditor" placeholder="Enter text">1</textarea>
  <button id="generateQR">Generate QR</button>
  <canvas id="qrCodeCanvas"></canvas>

  <script>
    document.getElementById('generateQR').addEventListener('click', async () => {
      const text = document.getElementById('textEditor').value.trim();
      const canvas = document.getElementById('qrCodeCanvas');

      if (!text) {
        alert("No text to generate QR");
        return;
      }

      try {
        // Set canvas size and clear
        canvas.width = 300;
        canvas.height = 300;
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        await QRCode.toCanvas(canvas, text, {
          width: 300,
          margin: 2
        });

        console.log('QR Code generated');

      } catch (err) {
        console.error('QR Error:', err);
        alert("Failed to generate QR: " + err.message);
      }
    });
  </script>
</body>
</html>
